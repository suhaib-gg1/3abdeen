<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ุนุงุจุฏูู</title>
<link rel="icon" type="image/x-icon" href="logo1.icon">
<link rel="shortcut icon" type="image/x-icon" href="logo1.icon">
<!-- Apply saved theme before CSS loads to avoid flash -->
<script>
  try {
    var t = localStorage.getItem('theme');
    if (t === 'dark') {
      document.documentElement.classList.add('dark');
    }
  } catch (e) {}
</script>
<link rel="stylesheet" href="styles.css">
<script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>

<header>
  <h1><img src="logo2.png" alt="ุดุนุงุฑ" class="app-logo"> ุนุงุจุฏูู</h1>
  <div class="header-controls">
    <div class="tabs">
      <button class="tab-btn active" id="tab-worship">
        <i data-lucide="heart"></i> ุนุจุงุฏุงุชู
      </button>
      <button class="tab-btn" id="tab-community">
        <i data-lucide="users"></i> ุชุญุฏูุงุชู
      </button>
    </div>
    <button id="hamburger-menu" class="hamburger-btn" aria-label="ุงููุงุฆูุฉ"><span></span><span></span><span></span></button>
  </div>
  <div id="side-menu" class="side-menu hidden">
    <button id="toggle-dark-menu" class="side-menu-item">๐ ุงููุถุน ุงููููู</button>
  </div>
</header>

<div id="clock"></div>

<!-- ูุงูุฐุฉ ุฃุฐูุงุฑ ุงูุตุจุงุญ ูุงููุณุงุก -->
<div id="azkar-modal" class="modal hidden" aria-hidden="true">
  <div class="modal-backdrop"></div>
  <div class="modal-content" role="dialog" aria-modal="true">
    <div class="modal-header">
      <h3 id="azkar-modal-title">ุฃุฐูุงุฑ ุงูุตุจุงุญ</h3>
      <button id="azkar-modal-close" class="modal-close">โ</button>
    </div>
    <div class="modal-body">
      <div id="azkar-text" style="line-height:1.8"></div>
      <div id="azkar-counter" class="muted">ุงูุชูุฑุงุฑ: <span id="azkar-remaining">1</span></div>
    </div>
    <div class="modal-footer" style="gap:0.5rem; justify-content:space-between;">
      <div style="display:flex; gap:0.5rem;">
        <button id="azkar-prev" class="btn">ุงูุณุงุจู</button>
        <button id="azkar-next" class="btn btn-blue">ุงูุชุงูู</button>
      </div>
      <button id="azkar-finish" class="btn btn-green">ุฅููุงุก</button>
    </div>
  </div>
</div>

<!-- ูุงูุฐุฉ ุงูุฃุฐูุงุฑ ุงูุฌุฏูุฏุฉ -->
<div id="dhikr-new-modal" class="modal hidden" aria-hidden="true">
  <div class="modal-backdrop"></div>
  <div class="modal-content" role="dialog" aria-modal="true">
    <div class="modal-header">
      <h3 id="dhikr-new-title">ุชุงุฌ ุงูุฐูุฑ</h3>
      <button id="dhikr-new-modal-close" class="modal-close">โ</button>
    </div>
    <div class="modal-body">
      <div id="dhikr-new-text" style="line-height: 1.8; font-size: 1.1rem; text-align: center; margin: 1rem 0;"></div>
      <div id="dhikr-new-counter" class="muted" style="text-align: center; font-size: 1rem;">ุงูุชูุฑุงุฑ: <span id="dhikr-new-remaining">1</span></div>
    </div>
    <div class="modal-footer" style="gap: 0.5rem; justify-content: space-between;">
      <div style="display: flex; gap: 0.5rem;">
        <button id="dhikr-new-prev" class="btn">ุงูุณุงุจู</button>
        <button id="dhikr-new-next" class="btn btn-blue">ุงูุชุงูู</button>
      </div>
      <button id="dhikr-new-finish" class="btn btn-green">ุฅููุงุก</button>
    </div>
  </div>
</div>

<!-- ูุงูุฐุฉ ูุงุฆูุฉ ุงูุงูุชูุงูุงุช -->
<div id="gratitude-list-modal" class="modal hidden" aria-hidden="true">
  <div class="modal-backdrop"></div>
  <div class="modal-content" role="dialog" aria-modal="true">
    <div class="modal-header">
      <h3>ูุงุฆูุฉ ุงูุงูุชูุงูุงุช</h3>
      <button id="gratitude-list-modal-close" class="modal-close">โ</button>
    </div>
    <div class="modal-body">
      <div id="gratitude-list-container">
        <!-- ุณูุชู ููุก ูุฐุง ุงููุณู ุจุงูุงูุชูุงูุงุช ุงููุญููุธุฉ -->
      </div>
    </div>
    <div class="modal-footer">
      <button id="gratitude-list-close" class="btn">ุฅุบูุงู</button>
    </div>
  </div>
</div>

<div id="worship-section" class="content-section active">
  <main>
    <!-- ุงูุตูุงุฉ -->
    <div class="card">
      <button class="card-header" id="btn-salah">
        <span><i data-lucide="sun"></i> ุงูุตููุงุช</span>
        <i id="arrow-salah" data-lucide="chevron-down"></i>
      </button>
      <div id="salah" class="card-content hidden">
        <ul id="prayer-times"></ul>
      </div>
    </div>

    <!-- ุงููุฑุขู -->
    <div class="card">
      <button class="card-header" id="btn-quran">
        <span><i data-lucide="book"></i> ุงููุฑุขู</span>
        <i id="arrow-quran" data-lucide="chevron-down"></i>
      </button>
      <div id="quran" class="card-content hidden">
        <label>ุงุฎุชุฑ ูุฑุฏู:</label>
        <select id="quran-choice">
          <option value="rubu">ุฑุจุน ุญุฒุจ (2.5 ุตูุญุฉ)</option>
          <option value="hizb">ุญุฒุจ (10 ุตูุญุงุช)</option>
          <option value="juz">ุฌุฒุก (20 ุตูุญุฉ)</option>
        </select>
        <div class="progress-bar-bg"><div id="quran-progress" class="progress-bar-fill quran-fill" style="width:0%;"></div></div>
        <button onclick="updateQuranProgress()" class="btn btn-green">ุฃูุฌุฒุช ูุฑุฏู</button>
      </div>
    </div>

    <!-- ุงูุฃุฐูุงุฑ -->
    <div class="card">
      <button class="card-header" id="btn-azkar">
        <span><i data-lucide="heart"></i> ุงูุฃุฐูุงุฑ</span>
       <i id="arrow-azkar" data-lucide="chevron-down"></i>
      </button>
      <div id="azkar" class="card-content hidden">
        <button id="btn-azkar-open" class="btn btn-blue">ุฃุฐูุงุฑ ุงูุตุจุงุญ</button>
        <div class="progress-bar-bg"><div id="dhikr-progress" class="progress-bar-fill combined-fill" style="width:0%;"></div></div>
        
        <!-- ูุณู ูุง ุชุณูุช -->
        <div class="dhikr-section">
          <p class="dhikr-title">ูุง ุชุณูุช</p>
          <div class="dhikr-buttons">
            <button onclick="openDhikrModal('taj')" class="btn btn-green">ุชุงุฌ ุงูุฐูุฑ</button>
            <button onclick="openDhikrModal('wudu')" class="btn btn-blue">ุจุนุฏ ุงููุถูุก</button>
            <button onclick="openDhikrModal('subhan')" class="btn btn-purple">ููู ูุงูุช ูุซู ุฒุจุฏ ุงูุจุญุฑ</button>
          </div>
        </div>
      </div>
    </div>

    <!-- ุงูุงูุชูุงู -->
    <div class="card">
      <button class="card-header" id="btn-gratitude">
        <span><i data-lucide="smile"></i> ุงูุงูุชูุงู</span>
        <i id="arrow-gratitude" data-lucide="chevron-down"></i>
      </button>
      <div id="gratitude" class="card-content hidden">
        <textarea id="gratitude-text" placeholder="ุงูุชุจ ุดูุฆุง ุฌูููุง ุญุฏุซ ุงูููู"></textarea>
        <div style="display: flex; gap: 0.75rem; margin-top: 0.75rem;">
          <button onclick="saveGratitude()" class="btn btn-purple" style="flex: 1; padding: 0.75rem 1rem; font-size: 1rem;">ุญูุธ</button>
          <button onclick="showGratitudeList()" class="btn btn-blue" style="flex: 1; padding: 0.75rem 1rem; font-size: 1rem;">ูุงุฆูุฉ ุงูุงูุชูุงูุงุช</button>
        </div>
      </div>
    </div>
  </main>
</div>

<div id="community-section" class="content-section">
  <!-- ุชุจููุจ ุงูุชุญุฏูุงุช -->
  <div class="community-tab">
    <div class="community-header">
      <h2>ุชุญุฏูุงุชู</h2>
      <p class="community-subtitle">ูุธูู ุชุญุฏูุงุชู ุงูููููุฉ ูุงูุฃุณุจูุนูุฉุ ูุชุชุจุน ุฅูุฌุงุฒุงุชู</p>
    </div>
    <div class="community-content">
      <!-- ุจุทุงูุงุช ุงูุฅุญุตุงุฆูุงุช -->
      <div class="community-stats">
        <div class="stat-item">
          <div id="stat-week-completed" class="stat-number">0</div>
          <div class="stat-label">ุงูุชุญุฏูุงุช ุงูููุฌุฒุฉ ูุฐุง ุงูุฃุณุจูุน</div>
        </div>
        <div class="stat-item">
          <div id="stat-max-week" class="stat-number">0</div>
          <div class="stat-label">ุฃูุจุฑ ุนุฏุฏ ุฃููุฌุฒ ูู ุฃุณุจูุน</div>
        </div>
        <div class="stat-item">
          <div id="stat-today-left" class="stat-number">0</div>
          <div class="stat-label">ุงูุฃูุงู ุงููุชุจููุฉ ูุฐุง ุงูุฃุณุจูุน</div>
        </div>
      </div>

      <!-- ุงูุชุญุฏูุงุช ุงูููููุฉ -->
      <div class="card">
        <div class="section-header">
          <h3>ุชุญุฏูุงุช ููููุฉ</h3>
          <button id="btn-add-daily" class="btn btn-blue">ุฅุถุงูุฉ ุชุญุฏู</button>
        </div>
        <div class="card-content">
          <h4 class="muted">ุซุงุจุชุฉ</h4>
          <ul id="daily-fixed-list" class="challenge-list"></ul>
          <h4 class="muted">ูุชุบูุฑุฉ ุงูููู</h4>
          <ul id="daily-rotating-list" class="challenge-list"></ul>
        </div>
      </div>

      <!-- ุงูุชุญุฏูุงุช ุงูุฃุณุจูุนูุฉ -->
      <div class="card">
        <div class="section-header">
          <h3>ุชุญุฏูุงุช ุฃุณุจูุนูุฉ</h3>
          <button id="btn-add-weekly" class="btn btn-purple">ุฅุถุงูุฉ ุชุญุฏู</button>
        </div>
        <div class="card-content">
          <h4 class="muted">ุซุงุจุชุฉ</h4>
          <ul id="weekly-fixed-list" class="challenge-list"></ul>
          <h4 class="muted">ูุชุบูุฑุฉ ูุฐุง ุงูุฃุณุจูุน</h4>
          <ul id="weekly-rotating-list" class="challenge-list"></ul>
        </div>
      </div>
    </div>
  </div>

  <!-- ูุงูุฐุฉ ุฅุถุงูุฉ ุงูุชุญุฏูุงุช -->
  <div id="challenge-modal" class="modal hidden" aria-hidden="true">
    <div class="modal-backdrop"></div>
    <div class="modal-content" role="dialog" aria-modal="true">
      <div class="modal-header">
        <h3>ุฅุถุงูุฉ ุชุญุฏู</h3>
        <button id="modal-close" class="modal-close">โ</button>
      </div>
      <div class="modal-body">
        <label>ููุน ุงูุชุญุฏู</label>
        <select id="challenge-scope">
          <option value="daily">ูููู</option>
          <option value="weekly">ุฃุณุจูุนู</option>
        </select>
        <label>ุทุฑููุฉ ุงูุธููุฑ</label>
        <select id="challenge-mode">
          <option value="fixed">ุซุงุจุช</option>
          <option value="rotating">ูุชุบูุฑ</option>
        </select>
        <label>ุงุณู ุงูุชุญุฏู</label>
        <input id="challenge-title" type="text" placeholder="ูุซุงู: ุตูุงุฉ ุงููุชุฑ" />
      </div>
      <div class="modal-footer">
        <button id="modal-save" class="btn btn-green">ุญูุธ</button>
      </div>
    </div>
  </div>
</div>

<script src="script.js"></script>
<script>
// ูุงุฆูุฉ ุงููุจุฑุบุฑ
const hamburger = document.getElementById('hamburger-menu');
const sideMenu = document.getElementById('side-menu');
hamburger.addEventListener('click', () => {
  sideMenu.classList.toggle('hidden');
});
// ุฅุบูุงู ุงููุงุฆูุฉ ุนูุฏ ุงูุถุบุท ุฎุงุฑุฌูุง
window.addEventListener('click', (e) => {
  if (!sideMenu.contains(e.target) && !hamburger.contains(e.target)) {
    sideMenu.classList.add('hidden');
  }
});
// ุชูุนูู ุงููุถุน ุงููููู ูู ุงููุงุฆูุฉ
const toggleDarkMenu = document.getElementById('toggle-dark-menu');
toggleDarkMenu.addEventListener('click', () => {
  document.documentElement.classList.toggle('dark');
  try {
    localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
  } catch (e) { console.warn('Storage not available'); }
  sideMenu.classList.add('hidden');
});
</script>
</body>
</html>